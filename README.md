# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π  
–ú–§–¢–ò ¬∑ –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ1 ¬∑ –§—Ä–µ–π–¥–∏–Ω–∞ –ê.–ò.

---

## 1. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–¶–µ–ª—å—é –ø—Ä–æ–µ–∫—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –∏ –∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö, –∞ —Ç–∞–∫–∂–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –¥–æ **—Ç—Ä–µ—Ç—å–µ–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã (3–ù–§)**.

–í —Ä–∞–±–æ—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:

- –∞–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–ª–∏–µ–Ω—Ç—ã + —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏);
- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π;
- –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (1–ù–§ ‚Üí 2–ù–§ ‚Üí 3–ù–§);
- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—ã;
- —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ PostgreSQL (CREATE TABLE);
- —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (mapping tables);
- –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è;
- –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–æ—á–Ω–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏.

–í—Å–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ –¥–∞–Ω–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---

## 2. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∞–ª –¥–≤–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –±–ª–æ–∫–∞:

- **–¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ (customer sheet)**: —Å–≤–µ–¥–µ–Ω–∏—è –æ –§–ò–û, –∞–¥—Ä–µ—Å–µ, –¥–µ–º–æ–≥—Ä–∞—Ñ–∏–∏, —Å–µ–≥–º–µ–Ω—Ç–µ, –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏;  
- **–¥–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (transaction sheet)**: —Å–≤–µ–¥–µ–Ω–∏—è –æ –ø–æ–∫—É–ø–∫–∞—Ö, —Ç–æ–≤–∞—Ä–∞—Ö –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏.

–§–æ—Ä–º–∞–ª—å–Ω–æ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–ª–∏—Å—å –≤ –≤–∏–¥–µ –¥–≤—É—Ö –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü –±–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π.

–î–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞–ª–∏:

- –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `F`, `Female`, `Femal`);
- –æ–ø–µ—á–∞—Ç–∫–∏: `Argiculture`;
- –Ω–µ–ø–æ–ª–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (`NULL`, –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏);
- product_id –Ω–µ–ª—å–∑—è —Ç—Ä–∞–∫—Ç–æ–≤–∞—Ç—å –∫–∞–∫ –∫–ª—é—á, —Ç.–∫. –æ–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–æ–º ‚Äî –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ product_id –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–æ–≤–∞—Ä–∞;
- —Å–º–µ—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ç–æ–≤–∞—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å–∞–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏);
- product —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (brand, product_line, class, size) –ª–µ–∂–∞—Ç –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Äî –ø–æ–≤—Ç–æ—Ä—è—é—â–∞—è—Å—è –≥—Ä—É–ø–ø–∞.

–≠—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è —Ç–∏–ø–∏—á–Ω–æ–π –¥–ª—è —Å—ã—Ä—ã—Ö ‚Äúdata lake‚Äù –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

---

## 3. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

## 3.1. –ü–µ—Ä–≤–∞—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ (1–ù–§)

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è 1–ù–§:

1. –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî **–∞—Ç–æ–º–∞—Ä–Ω—ã–µ**.  
2. –í —Å—Ç—Ä–æ–∫–∞—Ö –Ω–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –≥—Ä—É–ø–ø.  
3. –ù–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö, –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä.  
4. –í—Å–µ —Å—Ç—Ä–æ–∫–∏ –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã.

### –ë—ã–ª–æ –ª–∏ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ 1–ù–§?

**–î–∞, —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –≤ 1–ù–§.**

–ü–æ—á–µ–º—É:

- –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–∫–∞–ª—è—Ä–Ω–æ: —Å—Ç—Ä–æ–∫–∞ / —á–∏—Å–ª–æ / –¥–∞—Ç–∞;  
- –Ω–µ—Ç –º–Ω–æ–≥–æ–∑–Ω–∞—á–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤, –Ω–µ—Ç —Å–ø–∏—Å–∫–æ–≤;  
- gender, job_industry, state ‚Äî —Ö–æ—Ç—å –∏ –≥—Ä—è–∑–Ω—ã–µ, –Ω–æ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.

–¢–æ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã (`F`, `Female`, `Femal`),  
**–Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç 1–ù–§**, –ø–æ—Å–∫–æ–ª—å–∫—É –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å –Ω–µ —Å—Ç—Ä–∞–¥–∞–µ—Ç.

---

## 3.2. –í—Ç–æ—Ä–∞—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ (2–ù–§)

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è 2–ù–§:

- –¢–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ 1–ù–§;  
- –í—Å–µ –Ω–µ–∫–ª—é—á–µ–≤—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–æ–ª–∂–Ω—ã **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞**, –∞ –Ω–µ –æ—Ç —á–∞—Å—Ç–∏ —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –∫–ª—é—á–∞.

### –ü—Ä–æ–≤–µ—Ä–∫–∏:

#### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏  
–í —Ç–∞–±–ª–∏—Ü–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –µ—Å—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã:

- product_id
- brand  
- product_line  
- product_class  
- product_size  

–∫–æ—Ç–æ—Ä—ã–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ –Ω–æ–≤—É—é —Å—É—â–Ω–æ—Å—Ç—å **product** —Å –∫–ª—é—á–æ–º **product_id**, –æ–¥–Ω–∞–∫–æ **product_id** –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∞—Ç—Ä–∏–±—É—Ç–æ–º (–æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ **product_id** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–∞–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Ç–æ–≤–∞—Ä–∞). 

–¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –≤—Å–µ —ç—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ **transaction_id**, –∞ –Ω–µ –æ—Ç product_id ‚Üí –Ω–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏—è 2–ù–§.

#### –ö–ª–∏–µ–Ω—Ç  
–í —Ç–∞–±–ª–∏—Ü–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π **–ø—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á - customer_id**  ‚Üí –Ω–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏—è 2–ù–§.

---

## 3.3. –¢—Ä–µ—Ç—å—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ (3–ù–§)

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è 3–ù–§:

1. –¢–∞–±–ª–∏—Ü–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–æ 2–ù–§.  
2. –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤–∏–¥–∞:  
   **–∫–ª—é—á ‚Üí –∞—Ç—Ä–∏–±—É—Ç ‚Üí –¥—Ä—É–≥–æ–π –∞—Ç—Ä–∏–±—É—Ç**

### üö´ –ù–∞—Ä—É—à–µ–Ω–∏—è:

- state ‚Üí country

–¢–æ –µ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —à—Ç–∞—Ç, –∞ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ customer_id.  
–≠—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ 3–ù–§.

(–≤–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–ª—è –∞–¥—Ä–µ—Å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ post_code, address –Ω–∏–∫–∞–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ—Ç: –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —ç—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç state)

### ‚úî –ü–µ—Ä–µ—Ö–æ–¥ –∫ 3–ù–§:

–≠—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏:

- –°–æ–∑–¥–∞–Ω —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ **STATE_REF(state_code, state_name, country)**  
- –í —Ç–∞–±–ª–∏—Ü—É customer —Ç–µ–ø–µ—Ä—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `state_code`
- country –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –≤–Ω–µ—à–Ω–µ–º—É –∫–ª—é—á—É

---

# 4. –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

### ‚úî –ü–æ—á–µ–º—É –ø—Ä–æ–¥—É–∫—Ç ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞?
–ü–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è (brand, line, class, size) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–æ–≤–∞—Ä (–±—ã–ª —Å–æ–∑–¥–∞–Ω –∫–ª—é—á product_uid).  
product_id –≤ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö **–Ω–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç**, –∞ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞.

### –ü–æ—á–µ–º—É –∞–¥—Ä–µ—Å –ù–ï –≤—ã–¥–µ–ª–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å?

–ü–æ—Ç–æ–º—É —á—Ç–æ:

1. –í –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –∫–ª—é—á–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–ª –±—ã –∞–¥—Ä–µ—Å (–º–Ω–æ–≥–∏–µ –∫–ª–∏–µ–Ω—Ç—ã –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –∞–¥—Ä–µ—Å–æ–≤).
2. –ê–¥—Ä–µ—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–∞—è –±–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç—å –≤ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.
3. –ê–¥—Ä–µ—Å –Ω–µ –∏–º–µ–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–µ–º–∞–Ω—Ç–∏–∫–∏ (–Ω–µ—Ç –∑–¥–∞–Ω–∏—è, –≥–æ—Ä–æ–¥–∞, —É–ª–∏—Ü—ã ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∞).
4. –í—ã–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏–≤–µ–ª–æ –±—ã –∫ —É—Å–ª–æ–∂–Ω–µ–Ω–∏—é –±–µ–∑ –≤—ã–∏–≥—Ä—ã—à–∞ –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.

### –ü–æ—á–µ–º—É –Ω—É–∂–Ω—ã mapping-—Ç–∞–±–ª–∏—Ü—ã –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏?

–ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ **–Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏ –ù–§**, –∞ —è–≤–ª—è–µ—Ç—Å—è:

- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π;
- —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ–º –æ–ø–µ—á–∞—Ç–æ–∫ –∏ —Ä–∞–∑–Ω–æ—Ñ–æ—Ä–º–∞—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π;
- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤;
- –ø–æ–≤—ã—à–µ–Ω–∏–µ–º –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö;
- –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –∑–∞–¥–∞—á–∞–º.

#### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

### GENDER_REF + GENDER_MAP

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–í –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å —Ä–∞–∑–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª–∞:  
`F`, `Female`, `Femal`, `M`, `Male`, `U`.

**–†–µ—à–µ–Ω–∏–µ:**  
- GENDER_REF ‚Äî —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ–º–µ–Ω (`F`, `M`, `U`).
- GENDER_MAP ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π ‚Äú–≥—Ä—è–∑–Ω–æ–µ ‚Üí —á–∏—Å—Ç–æ–µ‚Äù.

**–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ù–§:**  
–ù–µ —Å–≤—è–∑–∞–Ω–æ —Å 1–ù–§‚Äì3–ù–§.  
–≠—Ç–æ ‚Äî –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

---

### INDUSTRY_REF + INDUSTRY_MAP

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –∏ –æ–ø–µ—á–∞—Ç–∫–∏ –≤ –æ—Ç—Ä–∞—Å–ª—è—Ö:  
`Health`, `Financial Services`, `Argiculture`, `NULL`, `n/a`.

**–†–µ—à–µ–Ω–∏–µ:**  
- INDUSTRY_REF ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∫–æ–¥—ã –æ—Ç—Ä–∞—Å–ª–µ–π.
- INDUSTRY_MAP ‚Äî —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—ã—Ä—ã—Ö —Å—Ç—Ä–æ–∫ —Å –∫–æ–¥–∞–º–∏.

**–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ù–§:**  
–û–ø—è—Ç—å –∂–µ, –Ω–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –∞ Data Quality + Domain Modeling.

---

### WEALTH_SEGMENT_REF

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–¢–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–µ–≥–º–µ–Ω—Ç–æ–≤, –±–µ–∑ –∫–æ–¥–æ–≤ –∏ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã.

**–†–µ—à–µ–Ω–∏–µ:**  
–¢–∞–±–ª–∏—Ü–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ —Å –∫–æ–¥–∞–º–∏ (`MASS`, `AFFL`, `HNW`) –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

**–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ù–§:**  
–ò–∑–Ω–∞—á–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ customer –Ω–µ –Ω–∞—Ä—É—à–∞–ª–∞ –ù–§.  
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ ‚Äî —É–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏.

---

### BRAND_REF / PRODUCT_LINE_REF / PRODUCT_CLASS_REF / PRODUCT_SIZE_REF

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ —Ä–∞–∑–º–∞–∑–∞–Ω–∞ –ø–æ transactional —Ç–∞–±–ª–∏—Ü–µ,
- —Å—Ç—Ä–æ–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è —Ç—ã—Å—è—á–∏ —Ä–∞–∑,
- –Ω–µ—Ç –∫–æ–¥–æ–≤ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞,
- –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, class_rank).

**–†–µ—à–µ–Ω–∏–µ:**

–í—ã–Ω–µ—Å–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏.

**–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ù–§:**

–≠—Ç–æ **–Ω–µ** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è 2–ù–§ –∏–ª–∏ 3–ù–§.  
Transaction –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∑–∞–≤–∏—Å–µ–ª–∞ —Ç–æ–ª—å–∫–æ –æ—Ç PK = transaction_id.

–°–æ–∑–¥–∞–Ω—ã –∫–∞–∫:
- –∏–∑–º–µ—Ä–µ–Ω–∏—è (dimensions),
- –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏,
- —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

---

### PRODUCT (–≤—ã–Ω–µ—Å–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:**

Transaction —Ö—Ä–∞–Ω–∏–ª–∞ product-–∞—Ç—Ä–∏–±—É—Ç—ã –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ:

- brand  
- line  
- class  
- size  
- list_price  
- standard_cost

–≠—Ç–æ –≤–µ–¥—ë—Ç –∫ –æ–≥—Ä–æ–º–Ω–æ–º—É –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é.

**–†–µ—à–µ–Ω–∏–µ:**

–°–æ–∑–¥–∞–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å PRODUCT, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é —Å—Å—ã–ª–∞—é—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

**–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ù–§:**

–§–æ—Ä–º–∞–ª—å–Ω–æ 3–ù–§ –Ω–µ –Ω–∞—Ä—É—à–∞–ª–∞—Å—å (PK –ø—Ä–æ—Å—Ç–æ–π).  
–ù–æ —ç—Ç–æ ‚Äî —Å–∏–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏:  
–ø—Ä–µ–¥–º–µ—Ç–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π.

---

# 5. ER-–¥–∏–∞–≥—Ä–∞–º–º–∞

–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –≤ –ø–∞–ø–∫–µ `diagram/DB_diagram.png` –∏ –ø—Ä–æ–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∏–∂–µ:

![ER Diagram](diagram/DB_diagram.png)

---

# 6. SQL-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ–ª–Ω—ã–π SQL-–∫–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ª–µ–∂–∏—Ç –≤ —Ñ–∞–π–ª–µ: sql/create_script.sql
–¢–∞–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã:

- CUSTOMER
- PRODUCT
- TRANSACTION
- GENDER_REF / GENDER_MAP
- STATE_REF / STATE_MAP
- INDUSTRY_REF / INDUSTRY_MAP
- WEALTH_SEGMENT_REF
- PRODUCT_LINE_REF
- PRODUCT_CLASS_REF
- PRODUCT_SIZE_REF
- BRAND_REF

![database](https://github.com/perceivery-mipt/DE_mipt/blob/main/diagram/database.png)

–ö–∞–∂–¥–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤–∫–ª—é—á–∞–µ—Ç:

- –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á,
- –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏,
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö,
- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è NOT NULL —Ç–∞–º, –≥–¥–µ —ç—Ç–æ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–æ –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

# 7. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL

–ó–∞–≥—Ä—É–∑–∫–∞ –±—ã–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:

---

### **6.1. –≠—Ç–∞–ø 1 ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

–ß–µ—Ä–µ–∑ DBeaver Import Wizard:

- customer_raw—Å_data.csv ‚Üí —Ç–∞–±–ª–∏—Ü–∞ customer_raw
- transaction_raw—Å_data.csv ‚Üí —Ç–∞–±–ª–∏—Ü–∞ transaction_raw

![customer_raw](https://github.com/perceivery-mipt/DE_mipt/blob/main/diagram/customer_raw.png)
![transaction_raw](https://github.com/perceivery-mipt/DE_mipt/blob/main/diagram/transaction_raw.png)

---

### **6.2. –≠—Ç–∞–ø 2 ‚Äî –æ—á–∏—Å—Ç–∫–∞ –∏ –≤—Å—Ç–∞–≤–∫–∞ –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å**

–®–∞–≥–∏:

1. –û—á–∏—Å—Ç–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π `gender`, `industry`, `state` —á–µ—Ä–µ–∑ MAP-—Ç–∞–±–ª–∏—Ü—ã  
2. –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –¥–∞—Ç, boolean-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Ç–æ–≤–∞—Ä–æ–≤ ‚Üí PRODUCT  
4. –í—Å—Ç–∞–≤–∫–∞ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ ‚Üí CUSTOMER  
5. –í—Å—Ç–∞–≤–∫–∞ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π ‚Üí TRANSACTION

![CUSTOMER_insert](https://github.com/perceivery-mipt/DE_mipt/blob/main/diagram/CUSTOMER_insert.png)
![PRODUCT_insert](https://github.com/perceivery-mipt/DE_mipt/blob/main/diagram/PRODUCT_insert.png)
![TRANSACTION_script](https://github.com/perceivery-mipt/DE_mipt/blob/main/diagram/TRANSACTION_script.png)

–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏:

- –°USTOMER ‚Äî 4000 —Å—Ç—Ä–æ–∫  
- PRODUCT ‚Äî 50 —Å—Ç—Ä–æ–∫  
- TRANSACTION ‚Äî 19997 —Å—Ç—Ä–æ–∫

![COUNT_DATA](https://github.com/perceivery-mipt/DE_mipt/blob/main/diagram/COUNT_DATA.png)

  
(3 —Å—Ç—Ä–æ–∫–∏ –±—ã–ª–∏ –æ—Ç–±—Ä–æ—à–µ–Ω—ã ‚Äî customer_id –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤ customer. –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –∑–∞–≥—Ä—É–∑–∏–≤ "–Ω—É–ª–µ–≤–æ–≥–æ" –∫–ª–∏–µ–Ω—Ç–∞ –≤ CUSTOMER, –æ–¥–Ω–∞–∫–æ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —É—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤)

---

# 8. –ò—Ç–æ–≥–∏ —Ä–∞–±–æ—Ç—ã

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ –∫ —Å—Ç—Ä–æ–≥–æ–π 3–ù–§.  
–°–æ–∑–¥–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∏ map-—Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è:

- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π,
- —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ–ø–µ—á–∞—Ç–æ–∫ –∏ –≥—Ä—è–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π,
- –≤—ã—Å–æ–∫–æ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏,
- –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

–ú–æ–¥–µ–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–∫—Ç–∏–∫–∞–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è Data Warehouse (dimension modeling), –ø—Ä–∏ —Ç–æ–º —á—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é —á–∏—Å—Ç–æ—Ç—É —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.


